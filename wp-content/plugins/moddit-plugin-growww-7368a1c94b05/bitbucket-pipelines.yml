# Moddit WordPress Plugin pipeline

# Stappen
# - Build files syncen (d.m.v rsync) via SSH naar de server

# Meer informatie en uitleg zijn te vinden in de moddit-bitbucket-pipelines repository:
# https://bitbucket.org/moddit/moddit-bitbucket-pipelines

pipelines:
  branches:
    master:
      - step:
          name: Upload files to production
          deployment: production
          caches:
            - docker
          script:
            - pipe: atlassian/rsync-deploy:0.11.1
              variables:
                USER: $DEPLOY_USER
                SERVER: $DEPLOY_HOST
                REMOTE_PATH: "~/domains/$DEPLOY_DOMAIN/public_html/wp-content/plugins/$DEPLOY_PATH"
                LOCAL_PATH: "${BITBUCKET_CLONE_DIR}/"
                EXTRA_ARGS: "--delete --info=name --exclude-from=deployment-exclude-list.txt"